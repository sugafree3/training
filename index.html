<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>演唱會搶票速度訓練模擬器</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #ff0080, #ff8c00);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.8;
            margin-bottom: 5px;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            justify-content: center;
        }
        
        .simulation-area {
            flex: 1;
            min-width: 300px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stats-area {
            flex: 1;
            min-width: 300px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .concert-info {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .concert-poster {
            width: 120px;
            height: 120px;
            border-radius: 8px;
            overflow: hidden;
            margin-right: 20px;
            background: linear-gradient(45deg, #ff0080, #ff8c00);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
        }
        
        .concert-details h2 {
            font-size: 1.8rem;
            margin-bottom: 8px;
        }
        
        .concert-details p {
            opacity: 0.8;
            margin-bottom: 5px;
        }
        
        .countdown {
            text-align: center;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 25px;
        }
        
        .countdown-text {
            font-size: 1.1rem;
            margin-bottom: 10px;
        }
        
        #countdown-timer {
            font-size: 2.5rem;
            font-weight: bold;
            color: #ff0080;
            text-shadow: 0 0 10px rgba(255, 0, 128, 0.5);
        }
        
        .ticket-area {
            position: relative;
            height: 200px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        #grab-button {
            padding: 20px 50px;
            font-size: 1.8rem;
            font-weight: bold;
            background: linear-gradient(90deg, #ff0080, #ff8c00);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(255, 0, 128, 0.4);
            transition: all 0.2s;
            opacity: 0;
            transform: scale(0.8);
            position: absolute;
        }
        
        #grab-button.visible {
            opacity: 1;
            transform: scale(1);
        }
        
        #grab-button:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(255, 0, 128, 0.6);
        }
        
        #grab-button:active {
            transform: scale(0.95);
        }
        
        .result-display {
            text-align: center;
            font-size: 1.3rem;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        
        #result-time {
            font-size: 2.2rem;
            font-weight: bold;
            color: #00ff88;
            text-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
            margin-top: 5px;
        }
        
        .stats-title {
            font-size: 1.8rem;
            margin-bottom: 20px;
            text-align: center;
            color: #ff8c00;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .stat-box {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2.2rem;
            font-weight: bold;
            color: #00ff88;
            margin: 10px 0 5px;
        }
        
        .stat-label {
            font-size: 1rem;
            opacity: 0.8;
        }
        
        .history-list {
            max-height: 250px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 15px;
        }
        
        .history-title {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: #ff8c00;
        }
        
        .history-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .history-item:last-child {
            border-bottom: none;
        }
        
        .history-time {
            color: #00ff88;
            font-weight: bold;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        button {
            padding: 12px 25px;
            font-size: 1.1rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        #start-btn {
            background: linear-gradient(90deg, #00b09b, #96c93d);
            color: white;
        }
        
        #reset-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .instructions {
            margin-top: 30px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
            font-size: 0.95rem;
            line-height: 1.6;
        }
        
        .instructions h3 {
            color: #ff8c00;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }
        
        .instructions ul {
            padding-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 8px;
        }
        
        .pulse {
            animation: pulse 0.5s infinite alternate;
        }
        
        @keyframes pulse {
            from { box-shadow: 0 0 10px rgba(255, 0, 128, 0.5); }
            to { box-shadow: 0 0 20px rgba(255, 0, 128, 0.8); }
        }
        
        .success {
            animation: success 1s ease;
        }
        
        @keyframes success {
            0% { background-color: #00ff88; }
            50% { background-color: #00ff88; }
            100% { background-color: transparent; }
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-guitar"></i> 演唱會搶票速度訓練模擬器</h1>
            <p class="subtitle">訓練你的反應速度，成為搶票達人！</p>
            <p class="subtitle">按鈕出現後，以最快速度點擊「立即搶票」按鈕</p>
        </header>
        
        <div class="main-content">
            <section class="simulation-area">
                <div class="concert-info">
                    <div class="concert-poster">
                        <i class="fas fa-music"></i>
                    </div>
                    <div class="concert-details">
                        <h2>超級巨星世界巡迴演唱會</h2>
                        <p><i class="far fa-calendar-alt"></i> 日期：2023年12月25日</p>
                        <p><i class="far fa-clock"></i> 時間：19:30 開場</p>
                        <p><i class="fas fa-map-marker-alt"></i> 地點：台北小巨蛋</p>
                        <p><i class="fas fa-ticket-alt"></i> 票價：$3,800 / $2,800 / $1,800</p>
                    </div>
                </div>
                
                <div class="countdown">
                    <div class="countdown-text">搶票按鈕出現倒數計時</div>
                    <div id="countdown-timer">5.00</div>
                </div>
                
                <div class="ticket-area">
                    <button id="grab-button">立即搶票！</button>
                </div>
                
                <div class="result-display">
                    <div>反應時間：</div>
                    <div id="result-time">-- 秒</div>
                </div>
                
                <div class="controls">
                    <button id="start-btn"><i class="fas fa-play-circle"></i> 開始訓練</button>
                    <button id="reset-btn"><i class="fas fa-redo-alt"></i> 重設數據</button>
                </div>
            </section>
            
            <section class="stats-area">
                <h2 class="stats-title">訓練統計數據</h2>
                
                <div class="stats-grid">
                    <div class="stat-box">
                        <div class="stat-label">嘗試次數</div>
                        <div class="stat-value" id="attempt-count">0</div>
                    </div>
                    
                    <div class="stat-box">
                        <div class="stat-label">最佳成績</div>
                        <div class="stat-value" id="best-time">--</div>
                    </div>
                    
                    <div class="stat-box">
                        <div class="stat-label">平均時間</div>
                        <div class="stat-value" id="average-time">--</div>
                    </div>
                    
                    <div class="stat-box">
                        <div class="stat-label">上次成績</div>
                        <div class="stat-value" id="last-time">--</div>
                    </div>
                </div>
                
                <div class="history">
                    <div class="history-title">最近10次記錄</div>
                    <div class="history-list" id="history-list">
                        <!-- 歷史記錄將在這裡動態生成 -->
                        <div class="history-item">尚未有記錄</div>
                    </div>
                </div>
            </section>
        </div>
        
        <div class="instructions">
            <h3><i class="fas fa-info-circle"></i> 使用說明</h3>
            <ul>
                <li>1. 點擊「開始訓練」按鈕開始模擬搶票</li>
                <li>2. 等待倒數計時結束，「立即搶票」按鈕會隨機出現</li>
                <li>3. 以最快速度點擊按鈕，系統會記錄你的反應時間</li>
                <li>4. 反覆練習以提高反應速度和穩定性</li>
                <li>5. 使用「重設數據」按鈕清除所有統計資料</li>
                <li><strong>目標：</strong>專業搶票者的平均反應時間約為0.2-0.3秒，試著挑戰這個成績！</li>
            </ul>
        </div>
    </div>

    <script>
        // 元素引用
        const grabButton = document.getElementById('grab-button');
        const startBtn = document.getElementById('start-btn');
        const resetBtn = document.getElementById('reset-btn');
        const countdownTimer = document.getElementById('countdown-timer');
        const resultTime = document.getElementById('result-time');
        const attemptCount = document.getElementById('attempt-count');
        const bestTime = document.getElementById('best-time');
        const averageTime = document.getElementById('average-time');
        const lastTime = document.getElementById('last-time');
        const historyList = document.getElementById('history-list');
        
        // 狀態變量
        let isActive = false;
        let startTime = 0;
        let reactionTimes = [];
        let countdownInterval = null;
        let countdownValue = 5;
        let buttonTimeout = null;
        
        // 從本地存儲加載數據
        function loadStats() {
            const savedTimes = localStorage.getItem('reactionTimes');
            if (savedTimes) {
                reactionTimes = JSON.parse(savedTimes);
                updateStats();
            }
        }
        
        // 保存數據到本地存儲
        function saveStats() {
            localStorage.setItem('reactionTimes', JSON.stringify(reactionTimes));
        }
        
        // 更新統計數據顯示
        function updateStats() {
            const count = reactionTimes.length;
            attemptCount.textContent = count;
            
            if (count > 0) {
                // 最佳成績（最短時間）
                const minTime = Math.min(...reactionTimes);
                bestTime.textContent = minTime.toFixed(3) + 's';
                
                // 平均時間
                const avgTime = reactionTimes.reduce((a, b) => a + b, 0) / count;
                averageTime.textContent = avgTime.toFixed(3) + 's';
                
                // 上次成績
                const last = reactionTimes[count - 1];
                lastTime.textContent = last.toFixed(3) + 's';
                
                // 更新歷史記錄
                updateHistory();
            } else {
                bestTime.textContent = '--';
                averageTime.textContent = '--';
                lastTime.textContent = '--';
                historyList.innerHTML = '<div class="history-item">尚未有記錄</div>';
            }
        }
        
        // 更新歷史記錄列表
        function updateHistory() {
            historyList.innerHTML = '';
            const recentTimes = reactionTimes.slice(-10).reverse();
            
            if (recentTimes.length === 0) {
                historyList.innerHTML = '<div class="history-item">尚未有記錄</div>';
                return;
            }
            
            recentTimes.forEach((time, index) => {
                const item = document.createElement('div');
                item.className = 'history-item';
                item.innerHTML = `
                    <span>嘗試 #${reactionTimes.length - index}</span>
                    <span class="history-time">${time.toFixed(3)} 秒</span>
                `;
                historyList.appendChild(item);
            });
        }
        
        // 開始訓練
        function startTraining() {
            if (isActive) return;
            
            isActive = true;
            startBtn.disabled = true;
            grabButton.classList.remove('visible');
            resultTime.textContent = '-- 秒';
            
            // 重置倒數計時
            countdownValue = 5;
            countdownTimer.textContent = countdownValue.toFixed(2);
            
            // 清除可能的計時器
            if (countdownInterval) clearInterval(countdownInterval);
            if (buttonTimeout) clearTimeout(buttonTimeout);
            
            // 開始倒數計時
            countdownInterval = setInterval(() => {
                countdownValue -= 0.01;
                countdownTimer.textContent = countdownValue.toFixed(2);
                
                if (countdownValue <= 0) {
                    clearInterval(countdownInterval);
                    countdownTimer.textContent = '0.00';
                    // 隨機延遲後顯示按鈕
                    const randomDelay = Math.random() * 2000 + 500; // 0.5-2.5秒隨機延遲
                    buttonTimeout = setTimeout(showButton, randomDelay);
                }
            }, 10);
        }
        
        // 顯示搶票按鈕
        function showButton() {
            if (!isActive) return;
            
            // 隨機位置
            const ticketArea = document.querySelector('.ticket-area');
            const areaWidth = ticketArea.clientWidth - grabButton.clientWidth;
            const areaHeight = ticketArea.clientHeight - grabButton.clientHeight;
            
            const randomX = Math.random() * areaWidth;
            const randomY = Math.random() * areaHeight;
            
            grabButton.style.left = `${randomX}px`;
            grabButton.style.top = `${randomY}px`;
            
            // 顯示按鈕並開始計時
            grabButton.classList.add('visible', 'pulse');
            startTime = Date.now();
            
            // 播放音效
            playBeepSound();
        }
        
        // 處理搶票按鈕點擊
        function handleGrabClick() {
            if (!isActive || startTime === 0) return;
            
            const reactionTime = (Date.now() - startTime) / 1000; // 轉換為秒
            reactionTimes.push(reactionTime);
            
            // 顯示結果
            resultTime.textContent = reactionTime.toFixed(3) + ' 秒';
            resultTime.parentElement.classList.add('success');
            
            // 視覺反饋
            document.body.style.backgroundColor = '#003315';
            setTimeout(() => {
                document.body.style.backgroundColor = '';
                resultTime.parentElement.classList.remove('success');
            }, 300);
            
            // 更新統計數據
            updateStats();
            saveStats();
            
            // 重置狀態
            resetTraining();
            
            // 播放成功音效
            playSuccessSound();
        }
        
        // 重置訓練
        function resetTraining() {
            isActive = false;
            startBtn.disabled = false;
            startTime = 0;
            grabButton.classList.remove('visible', 'pulse');
            
            if (countdownInterval) clearInterval(countdownInterval);
            if (buttonTimeout) clearTimeout(buttonTimeout);
            
            countdownTimer.textContent = '5.00';
        }
        
        // 重設所有數據
        function resetStats() {
            reactionTimes = [];
            updateStats();
            saveStats();
            resetTraining();
            resultTime.textContent = '-- 秒';
        }
        
        // 播放提示音
        function playBeepSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 800;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                console.log("音頻播放失敗，可能是瀏覽器限制");
            }
        }
        
        // 播放成功音效
        function playSuccessSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 1200;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.3);
                
                // 第二個高頻音
                setTimeout(() => {
                    const oscillator2 = audioContext.createOscillator();
                    const gainNode2 = audioContext.createGain();
                    
                    oscillator2.connect(gainNode2);
                    gainNode2.connect(audioContext.destination);
                    
                    oscillator2.frequency.value = 1500;
                    oscillator2.type = 'sine';
                    
                    gainNode2.gain.setValueAtTime(0.2, audioContext.currentTime);
                    gainNode2.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                    
                    oscillator2.start(audioContext.currentTime);
                    oscillator2.stop(audioContext.currentTime + 0.2);
                }, 150);
            } catch (e) {
                console.log("音頻播放失敗，可能是瀏覽器限制");
            }
        }
        
        // 事件監聽
        startBtn.addEventListener('click', startTraining);
        resetBtn.addEventListener('click', resetStats);
        grabButton.addEventListener('click', handleGrabClick);
        
        // 初始化
        loadStats();
        
        // 初始提示
        console.log("準備好訓練你的搶票反應速度了嗎？點擊「開始訓練」按鈕開始！");
    </script>
</body>
</html>
